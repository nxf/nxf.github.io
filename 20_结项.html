<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>结项 - Spring cloud</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01_介绍.html"><strong aria-hidden="true">1.</strong> 简介</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="01_Parent.html"><strong aria-hidden="true">1.1.</strong> 父项目搭建</a></li></ol></li><li class="chapter-item expanded "><a href="02_Eureka.html"><strong aria-hidden="true">2.</strong> Eureka</a></li><li class="chapter-item expanded "><a href="03_Ribbon_Hystrix.html"><strong aria-hidden="true">3.</strong> Ribbon&Hystrix</a></li><li class="chapter-item expanded "><a href="04_Feign.html"><strong aria-hidden="true">4.</strong> Feign</a></li><li class="chapter-item expanded "><a href="05_Gateway.html"><strong aria-hidden="true">5.</strong> Gateway</a></li><li class="chapter-item expanded "><a href="06_Config.html"><strong aria-hidden="true">6.</strong> Config</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="06_Config_Rabbit_install.html"><strong aria-hidden="true">6.1.</strong> Rabbit安装</a></li></ol></li><li class="chapter-item expanded "><a href="07_Sleuth.html"><strong aria-hidden="true">7.</strong> Sleuth</a></li><li class="chapter-item expanded "><a href="08_Admin.html"><strong aria-hidden="true">8.</strong> Admin</a></li><li class="chapter-item expanded "><a href="09_合同录入-上.html"><strong aria-hidden="true">9.</strong> 合同录入-上</a></li><li class="chapter-item expanded "><a href="10_合同录入-下.html"><strong aria-hidden="true">10.</strong> 合同录入-下</a></li><li class="chapter-item expanded "><a href="11_支付中心-上.html"><strong aria-hidden="true">11.</strong> 支付中心-上</a></li><li class="chapter-item expanded "><a href="12_支付中心-下.html"><strong aria-hidden="true">12.</strong> 支付中心-下</a></li><li class="chapter-item expanded "><a href="13_预约看房.html"><strong aria-hidden="true">13.</strong> 预约看房</a></li><li class="chapter-item expanded "><a href="14_RocketMQ-上.html"><strong aria-hidden="true">14.</strong> RocketMQ入门</a></li><li class="chapter-item expanded "><a href="15_RocketMQ-下.html"><strong aria-hidden="true">15.</strong> RocketMQ集群</a></li><li class="chapter-item expanded "><a href="16_预约看房消息推送.html"><strong aria-hidden="true">16.</strong> 预约看房消息推送</a></li><li class="chapter-item expanded "><a href="17_外卖抢单-上.html"><strong aria-hidden="true">17.</strong> 外卖抢单-上</a></li><li class="chapter-item expanded "><a href="18_外卖抢单-下.html"><strong aria-hidden="true">18.</strong> 外卖抢单-下</a></li><li class="chapter-item expanded "><a href="19_企业级测试与解决方案.html"><strong aria-hidden="true">19.</strong> 企业级测试与解决方案</a></li><li class="chapter-item expanded "><a href="20_结项.html" class="active"><strong aria-hidden="true">20.</strong> 结项</a></li><li class="chapter-item expanded "><a href="project/index.html"><strong aria-hidden="true">21.</strong> 项目</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="project/aijia/aijia.html"><strong aria-hidden="true">21.1.</strong> 爱家家具</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="project/aijia/analyze.html"><strong aria-hidden="true">21.1.1.</strong> 分析</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="resources.html">基础资源</a></li><li class="chapter-item expanded affix "><a href="mysql.html">mysql</a></li><li class="chapter-item expanded affix "><a href="redis.html">redis</a></li><li class="chapter-item expanded affix "><a href="security.html">security</a></li><li class="chapter-item expanded affix "><a href="front.html">前端</a></li><li class="chapter-item expanded affix "><a href="other.html">其他零碎</a></li><li class="chapter-item expanded affix "><a href="mail.html">邮件</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Spring cloud</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="合同录入"><a class="header" href="#合同录入">合同录入</a></h1>
<h2 id="设计表结构"><a class="header" href="#设计表结构">设计表结构</a></h2>
<ol>
<li>01.1 合理设计表结构至少包括合同表，合同付款计划表，采用spring cloud搭建微服务架构至少包括注册中心，配置中心，网关，合同服务。</li>
<li>02.1 合理设计表结构,用户表，患者表，数据字典表等（要求性别,学历,职业统一用数据字典表处理）</li>
<li>03.1 合理设计表结构,用户表，企业表，数据字典表等（要求所属行业：来自数据字典表）</li>
<li>04.1 合理设计表结构至少包括合同表，合同付款计划表，采用spring cloud搭建微服务架构至少包括注册中心，配置中心，网关，合同服务（要求：Spring Cloud - Eureka注册中心实现高可用功能）。</li>
</ol>
<h2 id="服务搭建"><a class="header" href="#服务搭建">服务搭建</a></h2>
<ol>
<li>01.2 Spring Cloud - Eureka注册中心实现高可用功能</li>
<li>01.3 Spring Cloud - Gateway网关路由</li>
<li>02.2 搭建spring cloud微服务架构，包括注册中心，配置中心，网关，用户服务，患者服务等.（要求：注册中心实现高可用，服务正常启动）</li>
<li>02.3 Spring Cloud - Gateway网关路由（要求：前端对服务访问均通过gateway访问；gateway网关配置路由；Gateway网关解决跨域问题）</li>
<li>03.2 搭建spring cloud微服务架构，包括注册中心，配置中心，网关，用户服务，企业服务等（注册中心实现高可用，服务正常启动）</li>
<li>03.3 Spring Cloud - Gateway网关路由（前端对服务访问均通过gateway访问；gateway网关配置路由；Gateway网关解决跨域问题）</li>
<li>03.4 服务监考（使用Admin查看用户服务的准实时日志，并演示实时调整日志等级）</li>
<li>04.2 Spring Cloud - Gateway网关路由（前端对服务访问均通过gateway访问；gateway网关配置路由；Gateway网关解决跨域问题）</li>
<li>05.6 Spring Cloud - Eureka注册中心（安装Eureka Server组件，并进行配置；启动Eureka Server并验证服务可用性）</li>
<li>05.8 Spring Cloud - Gateway网关路由（前端对用户中心，费用等系统的访问均通过gateway进行）</li>
<li>06.4 搭建Eureka服务，并将用户，商品等服务注册到Eureka中</li>
<li>06.5 使用Spring Cloud Gateway作为服务网关，所有对接口的调用都需要走网关，正确实现跨域配置</li>
<li>07.1 完成Eureka服务的搭建和配置，并将用户中心、服务管理系统接入Eureka</li>
<li>07.8 搭建网关服务，并合理配置路由，确保用户服务、服务管理服务等</li>
</ol>
<h2 id="链路追踪"><a class="header" href="#链路追踪">链路追踪</a></h2>
<ol>
<li>01.4 使用Zipkin作为链路追踪的框架，将所有的应用都集成到Zipkin上，并演示应用之间的调用链路和延迟时间等信息。</li>
<li>02.4 使用Zipkin作为链路追踪的框架，将所有的应用都集成到Zipkin上，并演示应用之间的调用链路和延迟时间等信息</li>
<li>04.3 使用Zipkin作为链路追踪的框架，将所有的应用都集成到Zipkin上，并演示应用之间的调用链路和延迟时间等信息</li>
<li>06.6 使用Zipkin作为链路追踪的框架，将所有的应用都集成到Zipkin上，并演示应用之间的调用链路和延迟时间等信息</li>
</ol>
<h2 id="合同列表"><a class="header" href="#合同列表">合同列表</a></h2>
<ol>
<li>01.5 正确分页，要求能够查看每个合同的付款计划列表。</li>
<li>02.6 患者列表正确展示(必须包含患者编号)，分页正确</li>
<li>03.6 企业列表页面（列表正确展示(必须包含企业编号)，分页正确）</li>
<li>04.5 合同列表（正确分页；用户登录只能查看自己录入的合同信息，非自己录入的不能查看；要求切换不同用户进行展示）</li>
<li>04.6 合同列表-搜索功能（根据合同编号精确查询；根据租客名称模糊查询；根据签约和到期日期精确查询）</li>
<li>05.1 费用管理 - 列表展示（按照生成日期降序排序；点击某一行可以进入该费用的详情页)</li>
<li>06.1 列表展示 使用Vue和ElementUI实现一个商品列表页面，要求包含商品名称、价格、单位、库存等信息，并支持分页</li>
<li>07.3 实现服务管理中的列表页，包括列表展示、搜索、分页等功能(完成根据服务类型（精确查询）和服务名称（模糊查询）的查询)</li>
<li>08.2  完成房屋列表，实现分页和根据名称查找功能。</li>
<li>10.2 完成房屋列表，实现分页和根据名称查找功能</li>
</ol>
<h2 id="格式验证"><a class="header" href="#格式验证">格式验证：</a></h2>
<ol>
<li>01.6 合同录入 -完成页面原型前端校验（签订日期小于结束日期；签订日期小于结束日期）</li>
<li>01.7 合同录入 -完成页面原型后端业务功能（解决合同编号重复问题；合同业务类型来自redis数据缓存；要考虑表单重复提交的解决方案）</li>
<li>02.7 患者添加功能（手机号和证件号码(身份证)进行格式校验；年龄必须在1-120岁区间）</li>
<li>03.7 企业添加功能-校验功能（手机号进行格式校验；数据字典表中的数据要求采用redis缓存；企业logo只能上传图片功能）</li>
<li>04.7 合同录入 -完成页面原型前端校验(租约开始日期小于结束日期;租约信息进行非空校验;提交合同录入后端要对用户是否登录进行校验，如果未登录不准录入合同)</li>
<li>09.2 完成房屋列表，实现分页和根据名称查找功能</li>
</ol>
<h2 id="用户登录"><a class="header" href="#用户登录">用户登录：</a></h2>
<ol>
<li>02.5 用户登录功能（用户名+密码登录；密码必须采用md5加密技术处理；考虑用户1分钟登录三次不正确进行锁定账号功能）</li>
<li>03.5 用户登录功能（用户名+密码登录；密码必须采用md5加密技术处理；考虑用户登录登录成功后采用jwt生成token返回給前端）</li>
<li>04.4 用户登录功能（用户名+密码登录；密码必须采用md5加密技术处理；考虑用户登录登录成功后采用jwt生成token返回給前端）</li>
<li>05.4 用户服务 - 用户登录（使用Vue和Element UI实现一个用户登录页面；前后端分离cookie跨域，页面跨域，登录成功，把认证标识写入cookie中）</li>
<li>07.2 用户登录功能实现，登录成功写入Cookie(前后端分离cookie跨域，登录成功，把用户信息写入cookie中;将用户信息放入redis中，供后面验证用户是否登录)</li>
<li>08.1 用户登录（前后端分离cookie跨域，页面跨域，登录成功后把必要信息写入cookie中）</li>
<li>09.1 用户登录 （前后端分离cookie跨域，页面跨域，登录成功后把必要信息写入cookie中）</li>
<li>10.1 用户登录 （前后端分离cookie跨域，页面跨域，登录成功后把必要信息写入cookie中）</li>
</ol>
<h2 id="合同添加"><a class="header" href="#合同添加">合同添加：</a></h2>
<ol>
<li>02.8 患者添加功能（性别,学历,职业统一来自数据字典表，且采用redis缓存；患者添加功能要考虑防止表单重复提交功能；每个患者要求生成一个唯一的患者编号）</li>
<li>03.8 企业添加功能（添加功能要考虑防止表单重复提交功能；每个企业要求生成一个唯一的患者编号；添加功能考虑用户是否登录进行校验(可以采用网关过滤器实现)）</li>
<li>04.8 合同录入 -完成页面原型后端业务功能(解决合同编号重复问题;要考虑表单重复提交的解决方案;合同录入成功合同录入人员为当前登陆用户;确保金额精度，使用BigDecimal数据类型)</li>
<li>05.2 费用管理 - 添加费用（输入客户名称、生成日期、合同金额等字段，选择费用类型信息，并进行表单验证；
点击添加按钮后，将费用信息提交到后端服务保存，并刷新费用列表页
；解决合同编号重复问题；后台合同金额使用BigDecimal，防止精度丢失）</li>
<li>05.3 费用管理 – 事务 （保存费用时，如果费用类型不存在则添加费用类型后再保存费用，否则直接添加费用即可；添加事务防止费用保存失败，导致数据不完整）</li>
<li>05.5 用户服务 - 用户注册（校验密码规则，必须包含数字、字母，长度大于6位）</li>
<li>06.2 添加商品功能- 要求用户可以输入商品的名称、价格、单位、库存等信息，并能够上传商品图片（确保价格金额精度，使用BigDecimal数据类型；防止保存失败，数据不完整，配置事务；添加商品编号，防止商品编号重复）</li>
<li>06.3 用户服务 - 实现一个简单的用户注册页面，要求用户可以输入用户名、密码等信息，并能够进行表单校验（前后端分离cookie跨域，页面跨域，登录成功，把认证标识写入cookie中）</li>
<li>06.8 创建商品时要防止表单重复提交</li>
<li>07.4 完成服务管理中的创建功能(适当处理防止重复预约;服务编号使用雪花算法防止重复)</li>
<li>08.3 可以针对选中的房屋生成租赁订单</li>
<li>08.4 创建租赁订单页面中，可以修改租赁时间区间，选择时间后即时获得租赁价格（价格计算必须是后端计算后返回给前端，主要使用BigDecimal计算）</li>
<li>08.6 创建租赁订单需要防止用户手误导致创建重复订单</li>
<li>08.7 租赁订单要确保唯一的订单号.</li>
<li>09.3 可以针对选中的房屋生成租赁订单</li>
<li>09.4 4. 创建租赁订单页面中，可以修改租赁时间区间，选择时间后即时获得租赁价格（价格计算必须是后端计算后返回给前端，主要使用BigDecimal计算）</li>
<li>09.6 创建租赁订单需要防止用户手误导致创建重复订单</li>
<li>09.7 租赁订单要确保唯一的订单号</li>
<li>10.3 可以针对选中的房屋生成租赁订单</li>
<li>10.4 创建租赁订单页面中，可以修改租赁时间区间，选择时间后即时获得租赁价格（价格计算必须是后端计算后返回给前端，主要使用BigDecimal计算）</li>
<li>10.6 创建租赁订单需要防止用户手误导致创建重复订单</li>
<li>10.7 租赁订单要确保唯一的订单号</li>
</ol>
<h2 id="feign"><a class="header" href="#feign">Feign</a></h2>
<ol>
<li>05.7 Spring Cloud - OpenFeign服务调用（添加费用时，远程（OpenFeign）调用用户中心，确认当前操作人已经登录系统）</li>
<li>07.5 创建服务时需要远程调用（Feign）用户服务，确保只有登录的用户才可以创建服务.</li>
<li>07.6 远程调用实现服务降级，当降级时任何用户都可以创建服务.</li>
<li>08.8 创建租赁订单时需要首先远程调用用户服务，确保只有登录用户才可以创建订单</li>
<li>09.8 创建租赁订单时需要首先远程调用用户服务，确保只有登录用户才可以创建订单</li>
<li>10.8 创建租赁订单时需要首先远程调用用户服务，确保只有登录用户才可以创建订单</li>
</ol>
<h2 id="文件上传"><a class="header" href="#文件上传">文件上传</a></h2>
<ol>
<li>06.7    实现一个简单的文件上传功能，要求用户可以选择本地的图片进行上传，并在后台进行保存。（商品图片上传失败，提示“上传失败”）</li>
</ol>
<h2 id="验证身份"><a class="header" href="#验证身份">验证身份：</a></h2>
<ol>
<li>08.5 创建租赁订单中需要填入租赁人的身份证和名称并验证是否真实</li>
<li>09.5 创建租赁订单中需要填入租赁人的身份证和名称并验证是否真实</li>
<li>10.5 创建租赁订单中需要填入租赁人的身份证和名称并验证是否真实</li>
</ol>
<h2 id="admin"><a class="header" href="#admin">Admin</a></h2>
<ol>
<li>07.7 使用Admin查看用户服务的准实时日志，并演示实时调整日志等级.</li>
</ol>
<h2 id="总体其他"><a class="header" href="#总体其他">总体其他：</a></h2>
<ol>
<li>01.8 合同录入 – 事务（合同录入提交后，要求根据分期付款方式完成付款计划的录入；确保付款金额精度，使用BigDecimal数据类型）</li>
</ol>
<h1 id="支付中心"><a class="header" href="#支付中心">支付中心</a></h1>
<h2 id="订单列表"><a class="header" href="#订单列表">订单列表：</a></h2>
<ol>
<li>11.1 页面展示：订单列表页面展示正常，包含金额字段和支付状态，使用element-ui实现</li>
<li>12.1 完成页面开发：包含必要字段：金额字段和支付状态</li>
<li>13.1 数据库设计和页面开发：订单信息表结构设计规范，完成服务列表页面开发</li>
<li>14.1 支付页面设计符合用户习惯，能快速完成支付操作</li>
<li>15.1 设计订单表，模拟订单数据。</li>
<li>16.1 使用Java编程语言生成虚拟订单数据，包括订单号、商品信息、金额等。</li>
<li>17.1 可以使用随机数或者测试框架来生成模拟数据，确保数据的真实性和合理性</li>
<li>18.1 使用Java编程语言生成虚拟订单数据，可以使用随机数或测试框架来生成模拟数据</li>
<li>19.1 设计订单表，模拟数据。</li>
<li>20.1 设计订单表，模拟数据</li>
</ol>
<h2 id="支付宝集成"><a class="header" href="#支付宝集成">支付宝集成：</a></h2>
<ol>
<li>11.2 支付宝SDK集成：参考官方文档进行集成，支付请求正常，能够跳转到支付宝页面</li>
<li>12.2 支付集成：支付宝支付接口正常集成，在订单页生成合法的支付链接。</li>
<li>13.2 支付集成：能够无缝对接支付宝支付</li>
<li>14.2 支付集成：集成支付宝支付接口，完成支付功能</li>
<li>15.2 Spring Boot集成支付宝</li>
<li>16.2 使用支付宝提供的SDK或API，结合Spring Boot框架，实现支付宝支付功能的集成</li>
<li>17.2 配置支付宝的商户信息、密钥等参数，并使用HTTPS协议与支付宝服务器进行交互</li>
<li>18.2 在应用的配置文件中配置支付宝的商户信息、密钥等参数，如商户号、应用ID、私钥等</li>
<li>19.2 在支付请求方法中，调用支付宝SDK或API提供的接口，将订单信息发送给支付宝服务器进行支付</li>
<li>20.2 创建一个支付服务类或控制器，实现支付功能的相关方法，如订单创建、支付请求发送和支付结果查询等</li>
</ol>
<h2 id="回调验签"><a class="header" href="#回调验签">回调验签：</a></h2>
<ol>
<li>11.3 支付宝回调处理：支付回调接口正确验签，对验签通过的请求，及时更新本地订单状态</li>
<li>12.3 回调处理：支付宝回调接口验证测试通过，接收支付宝回调，处理回调成功且正确</li>
<li>13.3 支付回调：回调接口能够接收支付宝的回调，验证签名安全，及时更新支付状态</li>
<li>14.3 支付回调：回调接口接收支付宝支付信息，验证确实为支付宝回调后再更新订单状态，确保支付信息的准确性</li>
<li>15.3 回调验签成功，处理后续业务</li>
<li>16.3 在支付宝支付完成后，支付宝会向指定的回调URL发送支付结果通知</li>
<li>17.3 在Spring Boot应用中配置回调URL，并实现接收和解析支付宝回调数据的逻辑</li>
<li>18.3 在接收回调通知的方法中，解析支付宝回调数据，可以使用支付宝SDK或API提供的工具类来解析。</li>
<li>18.4 <em>如果支付成功，更新订单状态为已支付，并记录相关支付信息</em></li>
<li>19.3 获取支付宝回调通知中的签名和其他参数，使用支付宝提供的验签规则对回调数据进行验签</li>
<li>20.3 验签成功后，验证订单信息的正确性，并处理支付结果。可以更新订单状态、生成支付记录、发送通知等操作</li>
<li>20.4 <strong>需要注意处理并发情况下的幂等性问题，确保多次回调不会重复处理订单。</strong></li>
</ol>
<h2 id="掉单处理"><a class="header" href="#掉单处理">掉单处理：</a></h2>
<ol>
<li>11.4 对于‘未支付’订单，系统能够定时进行处理，根据支付宝接口返回的状态更新本地订单状态</li>
<li>12.4 对于未能及时处理回调的订单，能够定时查询支付宝，并根据查询结果更新本地订单状态</li>
<li>15.4 调单处理，修改订单状态</li>
<li>16.4 检查支付宝回调通知中的支付状态，根据实际需求，处理支付成功或支付失败的订单</li>
<li>17.4 可以更新订单状态、生成支付记录、发送通知等操作，确保订单状态与支付宝同步 ？？</li>
<li>18.4 <em>如果支付成功，更新订单状态为已支付，并记录相关支付信息</em></li>
</ol>
<h2 id="关闭订单"><a class="header" href="#关闭订单">关闭订单：</a></h2>
<ol>
<li>11.5 支付关闭处理：对于超过30分钟没有支付成功的订单，及时关闭</li>
<li>14.5 支付通知：支付成功后，可通过短信或邮件通知用户支付成功，确保用户体验</li>
<li>15.5 未支付关闭订单发送RocketMQ异步消息通知 ？？看不懂。</li>
<li>16.5 根据业务需求设置订单的有效支付时间，超过该时间未支付的订单将自动关闭</li>
<li>18.5 <strong>订单创建时，设置订单的有效支付时间，超过该时间未支付的订单将自动关闭</strong></li>
<li>19.5 当订单被关闭时，将相关订单信息发送到RocketMQ的消息队列中</li>
</ol>
<h2 id="退款"><a class="header" href="#退款">退款：</a></h2>
<ol>
<li>13.5 退款功能：已支付的订单，完成退款功能，退款成功修改订单状态</li>
</ol>
<h2 id="支付成功通知"><a class="header" href="#支付成功通知">支付成功通知：</a></h2>
<ol>
<li>12.5 支付成功通知：对于成功支付的客户，及时向客户发送支付成功通知。</li>
<li>13.4 支付状态通知：在支付成功的情况下，能够用短信及时通知客户。</li>
<li>14.4 支付通知：支付成功后，可通过短信或邮件通知用户支付成功，确保用户体验</li>
</ol>
<h2 id="其他"><a class="header" href="#其他">其他：</a></h2>
<ol>
<li>17.5 使用RocketMQ作为消息队列，将未支付关闭的订单信息发送到消息队列中</li>
<li>19.4 <strong>如果支付失败，根据需要进行相应的处理操作，如取消订单、释放库存等</strong></li>
<li>20.5 在消费者中实现相应的逻辑，如记录日志、发送提醒等操作，以便及时处理关闭的订单信息 ？？</li>
</ol>
<h1 id="预约看房"><a class="header" href="#预约看房">预约看房</a></h1>
<h2 id="集成rocketmq"><a class="header" href="#集成rocketmq">集成RocketMQ</a></h2>
<ol>
<li>30.1 在支付模块中，集成、配置RocketMQ</li>
</ol>
<h2 id="消息消费"><a class="header" href="#消息消费">消息消费</a></h2>
<ol>
<li>30.2 配置RocketMQ的消费者，订阅&quot;payment_topic&quot;主题，处理支付消息相关业务逻辑</li>
<li>29.2 配置RocketMQ的消费者，订阅&quot;payment_topic&quot;主题，确保消费者能够接收到支付消息</li>
<li>28.4 异步并行处理消息，提高系统的吞吐量 </li>
<li>22.2 消息消费者从RocketMQ中获取消息，并异步处理（发送短信、邮件等）通。</li>
<li>21.2 接收方的消息消费者从RocketMQ中获取消息，之后通过发送短信、邮件通知用户</li>
</ol>
<h2 id="消息发送"><a class="header" href="#消息发送">消息发送</a></h2>
<ol>
<li>30.3 使用RocketMQ的异步发送方式，将消息发送到&quot;payment_topic&quot;主题</li>
<li>29.1 配置RocketMQ的生产者，设置主题为&quot;payment_topic&quot;，确保消息的可靠传递</li>
<li>29.4 在用户下单成功、支付成功或取消订单后，不直接同步发送短信或邮件，而是将相关信息封装成消息对象</li>
<li>28.1 确保用户下单成功、支付成功或取消订单等事件都能够触发短信发送或邮件发送 ？？都要发送这些消息吗</li>
<li>27.1 通过RocketMQ的生产者将相关信息封装成消息对象，并发送到指定的消息主题</li>
<li>26.1 确保支付模块中用户下单成功、支付成功或取消订单等事件能够触发消息发送，并在消息消费者端正确处理 ？？ 都要发送这些消息吗？</li>
<li>25.1 当用户下单成功、支付成功或取消订单时，调用RocketMQ的生产者发送相应的支付消息到&quot;payment_topic&quot;</li>
<li>25.4 使用RocketMQ的异步发送方式，将消息发送到&quot;payment_topic&quot;主题</li>
<li>24.1 消息发送设计。在用户完成下单或支付时，调用相应api将需要通知的信息封装成消息，通过RocketMQ发送至消息中间件</li>
<li>23.1 在用户完成一次购物行为（如下单、支付等）时，调用相应的服务接口将需要通知的信息封装成消息，通过RocketMQ发送至消息中间件。</li>
<li>21.1 对于业务流程中发送短信、邮件时需要使用RocketMQ中间件，实现业务解耦</li>
</ol>
<h3 id="消息发送配置"><a class="header" href="#消息发送配置">消息发送配置：</a></h3>
<ol>
<li>22.1 RocketMQ支持消息发送失败后自动重试，请使用同步发送消息并设置合适的重试次数和超时时间，以避免因网络波动等原因导致消息重复发送</li>
<li></li>
</ol>
<h2 id="防止重复消费"><a class="header" href="#防止重复消费">防止重复消费</a></h2>
<ol>
<li>30.4 使用Redis等缓存工具记录已经处理过的消息的唯一标识符，以防止重复消费</li>
<li>29.3 重复消费避免，在消息体中添加唯一标识符，如订单号或支付流水号，以防止重复消费</li>
<li>28.3 为了避免同一条消息被重复消费，我们会利用RocketMQ内置的消息去重机制和消费者端的幂等性处理功能  ？？内置消息去重</li>
<li>27.3 确保同一条消息不会被重复消费。消费者在处理消息之前，检查消息的唯一标识符或状态，并相应地进行处理逻辑</li>
<li>26.3 使用RocketMQ内置的消息去重机制，结合消费者端的幂等性处理，确保同一条消息不会被重复消费 ？？ 内置消息去重</li>
<li>25.3 可以使用Redis等缓存工具记录已经处理过的消息的唯一标识符，以防止重复消费</li>
<li>23.3 消费者消费消息时，需要注意重复消费的问题，避免重复消费导致业务异常</li>
<li>22.4 添加消息的唯一标识，例如订单号、支付流水号等作为消息ID，从而确保消息只被处理一次</li>
</ol>
<h2 id="防止消息丢失"><a class="header" href="#防止消息丢失">防止消息丢失</a></h2>
<ol>
<li>28.2 配置RocketMQ的生产者和消费者实例，确保消息不会丢失</li>
<li>27.2 RocketMQ采用高可靠的消息传递机制，能够准确地传递消息，且不会丢失</li>
<li>26.2 通过将消息发送到RocketMQ消息队列中，确保消息不会丢失，并能够在网络异常或其他问题后恢复正常消费</li>
</ol>
<h2 id="异步"><a class="header" href="#异步">异步？</a></h2>
<ol>
<li>27.4 将短信发送或邮件发送的动作解耦至异步线程中，提高系统的响应速度和并发能力  ？？</li>
<li>26.4 利用RocketMQ的异步发送特性，将短信发送或邮件发送的动作从主线程中解耦，提高系统的响应速度和并发能力</li>
</ol>
<h2 id="消息堆积"><a class="header" href="#消息堆积">消息堆积</a></h2>
<ol>
<li>24.3 消息堆积解决。 增加消息消费线程数：通过增加消息消费线程数，可以提高消息消费速度，减少消息堆积的可能性</li>
<li>22.3 增加消费者数量：通过增加消费者数量，可以提高消息消费速度，减少消息堆积的可能性</li>
<li>21.3 对于已经存在的消息堆积，通过启用多个消息消费者实例进行并行处理以解决消息积压问题</li>
</ol>
<h2 id="消息补偿"><a class="header" href="#消息补偿">消息补偿</a></h2>
<ol>
<li>24.4 消息补偿。在消息消费端，在消费消息处理流程中，例如发送短信或邮件出现错误时要尝试重试处理，例如重试3次，仍旧失败记录错误日志</li>
<li>23.4 消息消费补偿机制是指在消息消费过程中出现异常时，通过一定的机制进行重试。（例如短信发送失败后重试几次，仍旧失败记录错误日志信息</li>
<li>21.4 消息补偿机制是指在消息消费过程中出现异常时，通过一定的机制进行消息重试，尽量保证业务的正确性</li>
</ol>
<h2 id="异步2"><a class="header" href="#异步2">异步2</a></h2>
<ol>
<li>24.2 消息接收的设计。 消息消费者从RocketMQ中获取消息，将消息异步处理，例如发送短信、邮件通知用户</li>
<li>23.2 消息消费者从RocketMQ中获取消息，将消息异步处理，例如发送短信、邮件通知用户</li>
</ol>
<h2 id="消费者集群"><a class="header" href="#消费者集群">消费者集群</a></h2>
<ol>
<li>25.2 设置RocketMQ的消费者消费模式为集群模式，确保多个消费者能够<em>同时</em>消费消息，提高可靠性</li>
</ol>
<h1 id="外卖抢单"><a class="header" href="#外卖抢单">外卖抢单</a></h1>
<h2 id="线程池的使用"><a class="header" href="#线程池的使用">线程池的使用</a></h2>
<ol>
<li>40.1 通过合理的线程池参数配置，控制线程数量，避免资源耗尽和性能下降</li>
<li>39.1 利用线程池来管理和调度线程，确保系统能够高效处理大量请求</li>
<li>37.4 <strong>分析测试结果，优化系统性能，例如通过调整线程池大小、数据库连接池参数等来提升系统的处理能力</strong></li>
</ol>
<pre><code class="language-java">//初始化线程池 
@Configuration
public class ThreadPoolConfig {

    @Bean
    public ThreadPoolTaskExecutor executor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setMaxPoolSize(2);//线程池最多有2个线程
        executor.setCorePoolSize(1);//核心线程数为1
        executor.setThreadNamePrefix(&quot;*_*&quot;);//线程名称前缀
        executor.setQueueCapacity(100);//线程池等候队列
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.AbortPolicy());//拒绝策略
        executor.initialize();//初始化
        return executor;
    }
}
</code></pre>
<ol>
<li>38.1 使用Java多线程技术处理外卖抢单模块的并发请求</li>
<li>35.1 基于Spring Boot框架构建外卖抢单模块，使用Java多线程技术处理并发请求</li>
</ol>
<pre><code class="language-java">@RequestMapping(&quot;/process&quot;)
public Result&lt;Boolean&gt; createOrder(Book book) {
    executor.execute(() -&gt; {//使用多线程处理创建订单请求
        Order order = createOrder(book, 1,1);
        orderService.save(order);
    });
    return Result.ok(true);
}
</code></pre>
<ol>
<li>34.2 创建多个线程，并在每个线程中生成多个外卖订单</li>
<li>33.3 模拟用户产生大量订单 使用java多线程技术实现模拟</li>
<li>31.2 创建多个线程，并在每个线程中生成多个外卖订单</li>
</ol>
<pre><code class="language-java">    @RequestMapping(&quot;/creat_order&quot;)
    public Result&lt;Boolean&gt; creatOrder() {
        Book book = new Book();
        book.setId(1);
        book.setPrice(BigDecimal.TEN);
        for( int i=0;i&lt;3; i++) {
            executor.execute(() -&gt; {
                while(true) {
                    Order order = createOrder(book,1, 1);
                    orderService.save(order);
                    System.out.println(&quot;create order: &quot; + order.toString());
                    try {
                        Thread.sleep(RandomUtil.randomInt(100,2000));
                    } catch (InterruptedException e) {
                        throw new RuntimeException(e);
                    }
                }

            });
        }
        return Result.ok(true);
    }
</code></pre>
<h2 id="限流"><a class="header" href="#限流">限流</a></h2>
<pre><code class="language-yaml">
</code></pre>
<ol>
<li>40.2 当达到限流阈值时，返回合适的错误码或页面提示用户稍后再试 ？？ 怎么实现</li>
<li>39.2 设置适当的限流策略，例如限制API接口每秒请求数或并发请求数</li>
<li>38.2 基于网关做限流处理，以防止系统负载过高</li>
<li>37.2 当达到限流阈值时，可以返回适当的错误码或页面提示用户稍后再试</li>
<li>36.2 设置合理的限流策略，如限制API接口每秒请求数或并发请求数</li>
<li>35.2 使用分布式限流对外卖抢单接口进行访问频率的限制，防止系统负载过高</li>
<li>33.2 限制订单服务的访问频率 设定为每分钟最多18000次访问，并发最大200</li>
<li>32.4 考虑到产品运行在并发请求中，请实现一种方案，确保缓存和数据库中的数据保持一致</li>
<li>31.4 针对高峰时期流量过大可能引起的系统瘫痪问题实现相应解决方案</li>
</ol>
<h2 id="超卖"><a class="header" href="#超卖">超卖</a></h2>
<ol>
<li>40.3 根据订单状态和库存信息，使用Redis防止商品超卖 ？？怎么根据订单状态和库存信息。</li>
<li>39.3 使用Redis的原子操作，实现防止超卖问题的解决方案</li>
<li>38.3 使用Redis缓存热点数据，提高读取速度，减轻数据库压力</li>
<li>37.3 根据订单状态和库存信息，使用Redis维护每个商品的可售数量，并在抢单时进行原子操作，保证库存的准确性</li>
<li>36.3 在高并发场景下，使用Redis的原子操作（如incr/decr）实现防止超卖问题的解决方案</li>
<li>34.3 考虑多个外卖员同时抢某订单的情况，防止某订单被多人抢到 ？？和其它一样吗？</li>
<li>31.3 考虑多个外卖员同时抢某订单的情况，防止某订单被多人抢到</li>
</ol>
<h2 id="jmeter"><a class="header" href="#jmeter">JMeter</a></h2>
<ol>
<li>40.4 使用JMeter工具，分析测试结果</li>
<li>39.4 测试接口性能和稳定性，包括响应时间、吞吐量和错误率等指标</li>
<li>38.4 使用JMeter工具创建模拟请求，配置合理的线程数和并发用户数来模拟高峰期访</li>
<li>37.4 <strong>分析测试结果，优化系统性能，例如通过调整线程池大小、数据库连接池参数等来提升系统的处理能力</strong></li>
<li>36.4 测试外卖抢单模块的接口性能和稳定性，包括响应时间、吞吐量和错误率等指标</li>
<li>35.4 使用JMeter工具创建模拟请求，配置合理的线程数和并发用户数来模拟高峰期访问</li>
</ol>
<h2 id="事务"><a class="header" href="#事务">事务</a></h2>
<ol>
<li>37.1 使用数据库事务机制确保数据的一致性和并发操作的正确性</li>
</ol>
<h2 id="缓存"><a class="header" href="#缓存">缓存</a></h2>
<ol>
<li>35.3 商品加载到Redis缓存中，提高读取速度，减轻数据库压力</li>
<li>32.2 完成产品信息的缓存代码 只需要完成后端代码，缓存信息存放在redis中</li>
</ol>
<h2 id="缓存一致性"><a class="header" href="#缓存一致性">缓存一致性</a></h2>
<ol>
<li>32.3 完成产品更新功能。考虑到产品运行在并发请求中，请实现一种方案，确保缓存和数据库中的数据保持一致</li>
</ol>
<h2 id="订单关闭"><a class="header" href="#订单关闭">订单关闭</a></h2>
<ol>
<li>34.4 针对“支付中心”中超时未支付订单做出合理处理</li>
<li>33.1 对于支付模块中产生的订单，需要及时关闭未支付订单</li>
</ol>
<h2 id="建表"><a class="header" href="#建表">建表</a></h2>
<ol>
<li>36.1 设计合适的数据库表结构，准备用于保存订单的数据表</li>
<li>34.1 创建外卖订单表和相应的代码；参考上文中的“takeaway.sql”创建订单表。并生成相应的java代码以实现对该表操作</li>
<li>32.1 创建产品表和相应的代码 参考上文中的“product.sql”创建订单表。并生成相应的java代码以实现对该表操作</li>
<li>31.1 创建外卖订单表和相应的代码 （5分）参考上文中的“takeaway.sql”创建订单表。并生成相应的java代码以实现对该表操作</li>
</ol>
<h2 id="其他-1"><a class="header" href="#其他-1">其他</a></h2>
<ol>
<li>33.4 使用Postman实现创建订单，对订单创建请求进行安全验证 检验是否携带正确的token，只有带有正确token的请求才能创建成功</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="19_企业级测试与解决方案.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="project/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="19_企业级测试与解决方案.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="project/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="mermaid.min.js"></script>
        <script src="mermaid-init.js"></script>


    </body>
</html>
